<script src="../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/polymer/lib/elements/dom-if.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="shared-styles.html">

<dom-module id="topic-comments">
  <template>
    <style include="shared-styles iron-flex">
        :host {
            display: block;
        }

        .container {
            display: flex;
            align-items: center;
        }

        paper-fab {
          margin: 1rem auto;
        }

        .comment, .reply {
          margin-bottom: 5px;
        }

        .reply {
          margin-left: 40px;
        }

        .arrow-container {
          margin: 10px;
        }

        .up {
          color: green;
        }

        .down {
          color: red;
        }
    </style>

    <div class="centered">
      <template is="dom-if" if="{{!comments.length}}">
        <div class="missing">
          <iron-icon class="big-icon" icon="question-answer"></iron-icon>
          <h1>No comments!</h1>
          <p>It seems that no has yet commented. Would you like to start the
          discussion for this topic?</p>
          <paper-fab-morph is-overlay-content>
            <paper-fab icon="add" class="dropdown-trigger"></paper-fab>
          <paper-fab-morph>
        </div>
      </template>


      <template is="dom-repeat" items="{{comments}}" class="layout horizontal">
        <paper-card class="layout horizontal center comment">
          <div class="layout vertical arrow-container">
            <div class="up layout horizontal center">
              1
              <iron-icon class="star" icon="arrow-drop-up"></iron-icon>
            </div>
            <div class="down layout horizontal center">
              2
              <iron-icon class="star" icon="arrow-drop-down"></iron-icon>
            </div>
          </div>

          <div class="user-icon">
            <iron-image preload
                        src="https://avatars3.githubusercontent.com/u/1637946?v=3&s=460"
                        sizing="contain"
                        style="width:40px; min-width: 40px; height:40px;
                               margin: 1rem; margin-left: 0.5rem;"></iron-image>
          </div>

          <div class="card-content">
            {{item}}
          </div>
        </paper-card>

        <template is="dom-if" if="{{!index}}">
          <template is="dom-repeat" items="{{comment1_replies}}" class="layout horizontal" as="reply" index-as="index2">
            <paper-card class="layout horizontal center reply">
              <div class="layout vertical arrow-container">
                <div class="up layout horizontal center">
                  1
                  <iron-icon class="star" icon="arrow-drop-up"></iron-icon>
                </div>
                <div class="down layout horizontal center">
                  2
                  <iron-icon class="star" icon="arrow-drop-down"></iron-icon>
                </div>
              </div>
              <div class="user-icon">
                <iron-image preload
                            src="https://media.licdn.com/mpr/mpr/shrinknp_200_200/AAEAAQAAAAAAAAdjAAAAJDkzZTg5ZGVjLTk0OWMtNGZlYi1hZDQwLWQxMGEwMjI1ZDU2OQ.jpg"
                            sizing="contain"
                            style="width:40px; min-width: 40px; height:40px;
                                   margin: 1rem; margin-left: 0.5rem;"></iron-image>
              </div>
              <div class="card-content">
                {{reply}}
              </div>
            </paper-card>
          </template>
        </template>

      </template>
    </div>
  </template>

  <script>
    class TopicComments extends Polymer.Element {
      static get is() { return 'topic-comments'; }

      static get properties() {
        return {
          comments: {
            type: Array,
            value: ["comment1", "comment2"],
          },
          comment1_replies: {
            type: Array,
            value: ["reply1"],
          }
        }
      }

      // ready () {
      //   super.ready();
      //   var reply = Polymer.dom(this.root).querySelector('reply');
      //   var level = reply.attr('reply-level');
      //   reply.css('margin-left', level * 5);
      // }

      set_reply_indent() {
        alert("hi");

      }
    }

    window.customElements.define(TopicComments.is, TopicComments);
  </script>
</dom-module>
